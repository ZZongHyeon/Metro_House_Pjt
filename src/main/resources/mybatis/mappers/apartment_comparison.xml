<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.apartment_comparison.dao.ApartmentComparisonDAO">
<select id="getFavoriteListByUserNumber" parameterType="Integer" resultType="com.boot.apartment_comparison.dto.ApartmentComparisonDTO">
    SELECT DISTINCT
        f.FAVORITEID as favoriteId,
        f.USERNUMBER as userNumber,
        f.LAT as lat,
        f.LNG as lng,
        f.DEALAMOUNT as dealAmount,
        f.CREATEDAT as createdAt,
        i.APARTMENTID as apartmentId,
        i.APTNM as aptNm,
        i.ESTATEAGENTSGGNM as estateAgentSggNm,
        i.EXCLUUSEAR as excluUseAr,
        i.FLOOR as floor,
        i.BUILDYEAR as buildYear,
        i.ROADNM as roadNm,
        i.JIBUN as jibun,
        i.UMDNM as umdNm,
        i.SUBWAYSTATION as subwayStation,
        i.SUBWAYDISTANCE as subwayDistance
    FROM 
        APARTMENT_FAVORITE f
    LEFT JOIN 
        APARTMENTINFO i ON (
            ABS(f.LAT - i.LAT) &lt; 0.0000001
            AND ABS(f.LNG - i.LNG) &lt; 0.0000001
            AND f.DEALAMOUNT = i.DEALAMOUNT
        )
    WHERE 
        f.USERNUMBER = #{userNumber}
        AND i.APARTMENTID IS NOT NULL
    ORDER BY 
        f.CREATEDAT DESC
</select>
</mapper>